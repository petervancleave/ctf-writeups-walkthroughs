
First we have to RDP into the machine with the following credentials:

username: ElfMcBlue
password: TryH@cKMe1!
Server: 10.81.130.198

We can do this with remmina on our own VPN connected machine. The desktop looks like this:

<img width="1907" height="957" alt="ss1" src="https://github.com/user-attachments/assets/464e48de-d7c2-4276-a87d-b910820f1c13" />

# Static Analysis 

Static Analysis examines a binary / exectuable without running it. This is useful to find IoCs like hashes, strings, imported functions.

<img width="1312" height="716" alt="ss2" src="https://github.com/user-attachments/assets/ebff194a-0253-412d-9af5-495bd2c7515f" />

1. Launch PEStudio
Go to File > Open and navigate to Desktop > HopHelper > HopHelper.exe.

2. Extract the SHA-256 Hash
Locate the SHA-256 value (a long hexadecimal string).

<img width="1461" height="712" alt="SS3" src="https://github.com/user-attachments/assets/f0b99534-43ad-45cc-9d48-7336c9688f19" />

Q: **Static analysis:** What is the SHA256Sum of the HopHelper.exe?

A: F29C270068F865EF4A747E2683BFA07667BF64E768B38FBB9A2750A3D879CA33

3. Find hidden strings
Switch to the strings tab and scroll to the bottom of the output.

Look for readable text, including a flag in the format THM{XXXXX}

<img width="1502" height="722" alt="SS4" src="https://github.com/user-attachments/assets/6b023595-12e1-4779-88ab-185af73fde9d" />

Q: **Static analysis:** Within the strings of HopHelper.exe, a flag with the format THM{XXXXX} exists. What is that flag value?

Note, this can be found towards the bottom of the strings output.

A: THM{STRINGS_FOUND}

# Dynamic Analysis

Dynamic Analysis involves executing a malware sample to identify its behaviour and how it interacts with the OS.

1. Regshot
Launch Regshot x64 from the Desktop
Set the Output to Desktop
Click 1st Shot > Shot. This captures the current registry state.

2. Execute the Malware
Execute HopHelper.exe from the HopHelper folder
**Observations**:
- Desktop icons change into Easter eggs 
- Pop-up notification: "King Malhare sends his regards" 

3. Regshot 2
Take a snapshot post malware execution
Click 2nd Shot > Shot

4. Compare
Click Compare to generate a .txt file that can be accessed from the Desktop
Open the .txt file using Notepad

<img width="1742" height="766" alt="ss5" src="https://github.com/user-attachments/assets/a50c0484-dd9f-4c18-8d17-317f1c955130" />

Search the file (Ctrl + F) for "Run" or "HopHelper" to see paths containing HopHelper.exe

<img width="1585" height="747" alt="ss6" src="https://github.com/user-attachments/assets/ed6977ec-79b5-4521-9eec-42101b0a3969" />


Q: **Dynamic analysis:** What registry value has the HopHelper.exe modified for persistence?

Note: Provide the full path of the key that has been modified

A: HKU\S-1-5-21-1966530601-3185510712-10604624-1008\Software\Microsoft\Windows\CurrentVersion\Run\HopHelper


Next we can check network activity using ProcMon

1. Launch ProcMon
Launch ProcMon from the Desktop and scroll to the bottom to see the newest entries.

<img width="1695" height="843" alt="ss7" src="https://github.com/user-attachments/assets/b61560ba-21e5-4339-876a-95d308a79681" />

3. Malware
Re-execute the malware. Run HopHelper.exe again

4. Filter the Capture
We can change the filter to the following:

- **Filter > Filter...**
- Add: **Process Name** is hophelper.exe > Include > OK.
- Add another: **Operation** contains TCP > Include > OK.

<img width="1407" height="743" alt="ss8" src="https://github.com/user-attachments/assets/5b1b1fab-44b6-4f2c-8868-4e8f565af647" />


4. Analyze
Look at the TCP rows. The connections reveal the network protocol that was used (breachblocker-sandbox:http).

Q: **Dynamic analysis**: Filter the output of ProcMon for "TCP" operations. What network protocol is HopHelper.exe using to communicate?

Make sure to have executed HopHelper.exe while ProcMon was open and capturing events.

A: http


---

Bonus: Can you find the web panel that HopHelper.exe is communicating with?

We can visit:
http://breachblocker-sandbox

using the provided web browser in the box.

<img width="1141" height="746" alt="SS9" src="https://github.com/user-attachments/assets/96f3cb9d-0a89-4f7b-b30e-b02d258a14d0" />



