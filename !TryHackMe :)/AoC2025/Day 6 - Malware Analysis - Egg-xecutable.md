
First we have to RDP into the machine with the following credentials:

username: ElfMcBlue
password: TryH@cKMe1!
Server: 10.81.130.198

We can do this with remmina on our own VPN connected machine. The desktop looks like this:

# Static Analysis 

Static Analysis examines a binary / exectuable without running it. This is useful to find IoCs like hashes, strings, imported functions.

1. Launch PEStudio
Go to File > Open and navigate to Desktop > HopHelper > HopHelper.exe.

2. Extract the SHA-256 Hash
Locate the SHA-256 value (a long hexadecimal string).

Q: **Static analysis:** What is the SHA256Sum of the HopHelper.exe?

A: F29C270068F865EF4A747E2683BFA07667BF64E768B38FBB9A2750A3D879CA33

3. Find hidden strings
Switch to the strings tab and scroll to the bottom of the output.

Look for readable text, including a flag in the format THM{XXXXX}

Q: **Static analysis:** Within the strings of HopHelper.exe, a flag with the format THM{XXXXX} exists. What is that flag value?

Note, this can be found towards the bottom of the strings output.

A: THM{STRINGS_FOUND}

# Dynamic Analysis

Dynamic Analysis involves executing a malware sample to identify its behaviour and how it interacts with the OS.

1. Regshot
Launch Regshot x64 from the Desktop
Set the Output to Desktop
Click 1st Shot > Shot. This captures the current registry state.

2. Execute the Malware
Execute HopHelper.exe from the HopHelper folder
**Observations**:
- Desktop icons change into Easter eggs 
- Pop-up notification: "King Malhare sends his regards" 

3. Regshot 2
Take a snapshot post malware execution
Click 2nd Shot > Shot

4. Compare
Click Compare to generate a .txt file that can be accessed from the Desktop
Open the .txt file using Notepad

Search the file (Ctrl + F) for "Run" or "HopHelper" to see paths containing HopHelper.exe

Q: **Dynamic analysis:** What registry value has the HopHelper.exe modified for persistence?

Note: Provide the full path of the key that has been modified

A: HKU\S-1-5-21-1966530601-3185510712-10604624-1008\Software\Microsoft\Windows\CurrentVersion\Run\HopHelper


Next we can check network activity using ProcMon

1. Launch ProcMon
Launch ProcMon from the Desktop and scroll to the bottom to see the newest entries.

2. Malware
Re-execute the malware. Run HopHelper.exe again

3. Filter the Capture
We can change the filter to the following:

- **Filter > Filter...**
- Add: **Process Name** is hophelper.exe > Include > OK.
- Add another: **Operation** contains TCP > Include > OK.

4. Analyze
Look at the TCP rows. The connections reveal the network protocol that was used (breachblocker-sandbox:http).

Q: **Dynamic analysis**: Filter the output of ProcMon for "TCP" operations. What network protocol is HopHelper.exe using to communicate?

Make sure to have executed HopHelper.exe while ProcMon was open and capturing events.

A: http


---

Bonus: Can you find the web panel that HopHelper.exe is communicating with?

We can visit:
http://breachblocker-sandbox

using the provided web browser in the box.

